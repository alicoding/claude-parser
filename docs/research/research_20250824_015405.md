
## Research Query - 2025-08-24 01:54:14

**Query:** python library undo redo command pattern memento history management

**Response:**

For **undo/redo command pattern and memento-style history management in Python**, the highest-level, purpose-built library is **py-undo-stack**. This library implements the Command pattern and provides robust undo/redo stack management out of the box[5].

**Recommended Library: py-undo-stack**

- **Implements**: Command pattern, undo/redo stacks, command grouping, and history management.
- **Use case**: Any application needing undo/redo for arbitrary commands, including those with side effects or requiring custom logic.
- **Library-first**: Handles all core logic; you only define your commands.

**Basic Example:**

```python
from undostack import UndoStack, UndoCommand

class AddTextCommand(UndoCommand):
    def __init__(self, document, text):
        super().__init__("Add Text")
        self.document = document
        self.text = text

    def redo(self):
        self.document.append(self.text)

    def undo(self):
        self.document.pop()

doc = []
stack = UndoStack()
stack.push(AddTextCommand(doc, "Hello"))
stack.push(AddTextCommand(doc, "World"))

print(doc)  # ['Hello', 'World']
stack.undo()
print(doc)  # ['Hello']
stack.redo()
print(doc)  # ['Hello', 'World']
```

- **No need to write your own stack, history, or glue logic**â€”just subclass `UndoCommand` and implement `undo`/`redo`[5].

**Why not just use Memento pattern or roll your own?**
- The Memento pattern (see GeeksforGeeks[2]) is useful for simple state snapshots, but does not handle side effects, command grouping, or complex undo/redo flows[3].
- py-undo-stack is designed for real-world apps, not just toy examples.

**Summary Table**

| Library         | Pattern(s)      | Handles Side Effects | Command Grouping | Declarative API | Notes                |
|-----------------|----------------|---------------------|------------------|-----------------|----------------------|
| py-undo-stack   | Command, Undo   | Yes                 | Yes              | Yes             | Best for most cases  |
| Memento (manual)| Memento         | No                  | No               | No              | Only for simple state|

**Recommendation:**  
Use **py-undo-stack** for any serious undo/redo and history management in Python. Only use manual Memento pattern for trivial, stateless cases.

If you need installation or advanced usage examples, let me know your specific use case or requirements.

---
